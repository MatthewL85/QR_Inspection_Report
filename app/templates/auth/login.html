<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login | LogixPM</title>

  <!-- Material Dashboard 2 + Fonts -->
  <link href="https://cdn.jsdelivr.net/npm/@material-dashboard/bootstrap@latest/css/material-dashboard.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@300;400;600&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />

  <style>
  body {
    font-family: 'Public Sans', sans-serif;
    background: linear-gradient(135deg, #f5f7fa, #e8edf3);
  }
  .login-wrapper { display: flex; align-items: center; justify-content: center; min-height: 100vh; padding: 2rem; }
  .login-card { background-color: #fff; border-radius: 1rem; padding: 2.5rem 2rem; box-shadow: 0 12px 32px rgba(0,0,0,.06); width: 100%; max-width: 450px; }
  .auth-logo { width: 50px; height: auto; }
  .welcome-title { font-size: 1.75rem; font-weight: 600; color: #344767; }
  .text-muted-small { font-size: .95rem; color: #8392ab; }
  .form-label { font-weight: 500; color: #344767; }
  .form-control { border-radius: .4rem; height: 45px; font-size: 1rem; padding: .6rem .75rem; border: 1px solid #d2d6da; }
  .form-control:focus { border-color: #3a416f; box-shadow: 0 0 0 .15rem rgba(58,65,111,.25); }
  .form-check-label { font-size: .9rem; color: #7b809a; }
  .btn-login { background-color: #3a416f; color: #fff; font-weight: 600; font-size: 1rem; padding: .75rem; border-radius: .5rem; border: none; }
  .btn-login:hover { background-color: #2c3355; }
  .error-text { font-size: .875rem; color: #dc3545; margin-top: .25rem; }
  @media (max-width: 576px) {
    .welcome-title { font-size: 1.4rem; }
    .login-card { padding: 2rem 1.25rem; }
  }
  </style>
</head>

<body>
  <div class="login-wrapper">
    <div class="login-card">

      <!-- Logo & Welcome -->
      <div class="text-center mb-4">
        <img src="{{ url_for('static', filename='assets/img/logo.png') }}" alt="LogixPM Logo" class="auth-logo mb-2">
        <div class="welcome-title">Welcome Back</div>
        <p class="text-muted-small">Please sign in to continue</p>
      </div>

      <!-- Flash Messages -->
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, message in messages %}
            <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
              {{ message }}
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
          {% endfor %}
        {% endif %}
      {% endwith %}

      <!-- Login Form -->
      <form method="POST" action="{{ url_for('auth.login') }}">
        {{ form.hidden_tag() }}

        <!-- Identifier (Email or Username) -->
        <div class="mb-3 w-100">
          {{ form.identifier.label(class="form-label") }}
          <div class="input-group">
            {{ form.identifier(class="form-control form-control-lg w-100", placeholder="you@example.com or yourusername") }}
          </div>
          {% if form.identifier.errors %}
            <div class="error-text">{{ form.identifier.errors[0] }}</div>
          {% endif %}
        </div>

        <!-- Password -->
        <div class="mb-3 w-100">
          {{ form.password.label(class="form-label") }}
          <div class="input-group">
            {{ form.password(class="form-control form-control-lg w-100", placeholder="Enter your password") }}
          </div>
          {% if form.password.errors %}
            <div class="error-text">{{ form.password.errors[0] }}</div>
          {% endif %}
        </div>

        {# 2FA (future)
        <div class="mb-3 w-100">
          <label for="two_factor_code" class="form-label">2FA Code</label>
          <input type="text" name="two_factor_code" class="form-control form-control-lg w-100" placeholder="Enter 2FA Code (if enabled)">
        </div>
        #}

        <!-- Remember me -->
        <div class="form-check mb-3">
          {{ form.remember_me(class="form-check-input", id="remember_me") }}
          <label class="form-check-label" for="remember_me">Remember me</label>
        </div>

        <!-- Submit -->
        <div class="d-grid mb-3">
          <button type="submit" class="btn btn-login w-100">Sign In</button>
        </div>

        <div class="text-center">
          <a href="{{ url_for('auth.forgot_password') }}" class="text-decoration-none text-secondary small">
            Forgot your password?
          </a>
        </div>
      </form>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@material-dashboard/bootstrap@latest/js/material-dashboard.min.js"></script>
</body>
</html>
